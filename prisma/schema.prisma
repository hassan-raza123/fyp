// prisma/schema.prisma
datasource db {
  provider = "mysql" // Ya "postgresql" agar PostgreSQL use kar rahe hain
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id            Int      @id @default(autoincrement())
  username      String?  @unique  // Optional bana diya
  email         String   @unique
  password_hash String
  role          Role
  status        Status   @default(active)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  student       Student?
  managedDepartments Department[]
}

model Student {
  id             Int        @id @default(autoincrement())
  userId         Int        @unique
  rollNumber     String     @unique
  department     Department? @relation(fields: [departmentId], references: [id])
  departmentId   Int?
  program        Program?    @relation(fields: [programId], references: [id])
  programId      Int?
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
  user           User        @relation(fields: [userId], references: [id])
}

model Department {
  id             Int        @id @default(autoincrement())
  name           String
  code           String     @unique
  admin          User?      @relation(fields: [adminId], references: [id])
  adminId        Int?
  status         Status     @default(active)
  programs       Program[]
  students       Student[]  // Student ke liye relation
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
}

model Program {
  id             Int        @id @default(autoincrement())
  name           String
  code           String     @unique
  department     Department @relation(fields: [departmentId], references: [id])
  departmentId   Int
  status         Status     @default(active)
  students       Student[]  // Student ke liye relation
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
}

enum Role {
  super_admin
  department_admin
  child_admin
  teacher
  student
}

enum Status {
  active
  inactive
}